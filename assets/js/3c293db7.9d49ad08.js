"use strict";(self.webpackChunkeloquent=self.webpackChunkeloquent||[]).push([[4595],{3905:(e,a,n)=>{n.d(a,{Zo:()=>u,kt:()=>g});var i=n(7294);function t(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);a&&(i=i.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){t(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,i,t=function(e,a){if(null==e)return{};var n,i,t={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var c=i.createContext({}),l=function(e){var a=i.useContext(c),n=a;return e&&(n="function"==typeof e?e(a):o(o({},a),e)),n},u=function(e){var a=l(e.components);return i.createElement(c.Provider,{value:a},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var a=e.children;return i.createElement(i.Fragment,{},a)}},m=i.forwardRef((function(e,a){var n=e.components,t=e.mdxType,r=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(n),m=t,g=d["".concat(c,".").concat(m)]||d[m]||p[m]||r;return n?i.createElement(g,o(o({ref:a},u),{},{components:n})):i.createElement(g,o({ref:a},u))}));function g(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var r=n.length,o=new Array(r);o[0]=m;var s={};for(var c in a)hasOwnProperty.call(a,c)&&(s[c]=a[c]);s.originalType=e,s[d]="string"==typeof e?e:t,o[1]=s;for(var l=2;l<r;l++)o[l]=n[l];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7539:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var i=n(7462),t=(n(7294),n(3905));const r={sidebar_position:4},o="Vistas y rutas protegidas",s={unversionedId:"tutorial-basics/Vistas/rutasprotegidas",id:"tutorial-basics/Vistas/rutasprotegidas",title:"Vistas y rutas protegidas",description:"Introducci\xf3n",source:"@site/docs/tutorial-basics/Vistas/rutasprotegidas.md",sourceDirName:"tutorial-basics/Vistas",slug:"/tutorial-basics/Vistas/rutasprotegidas",permalink:"/curso-laravel/docs/tutorial-basics/Vistas/rutasprotegidas",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tutorial-basics/Vistas/rutasprotegidas.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"M\xe1s sobre vistas",permalink:"/curso-laravel/docs/tutorial-basics/Vistas/vista"},next:{title:"Operaciones CRUD",permalink:"/curso-laravel/docs/tutorial-basics/Vistas/crud"}},c={},l=[{value:"Introducci\xf3n",id:"introducci\xf3n",level:2},{value:"JetStream",id:"jetstream",level:2},{value:"Cambiar la p\xe1gina de inicio de la aplicaci\xf3n",id:"cambiar-la-p\xe1gina-de-inicio-de-la-aplicaci\xf3n",level:2},{value:"Modificando nuestro Layout",id:"modificando-nuestro-layout",level:2}],u={toc:l},d="wrapper";function p(e){let{components:a,...n}=e;return(0,t.kt)(d,(0,i.Z)({},u,n,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"vistas-y-rutas-protegidas"},"Vistas y rutas protegidas"),(0,t.kt)("h2",{id:"introducci\xf3n"},"Introducci\xf3n"),(0,t.kt)("p",null,"En nuestra aplicaci\xf3n habr\xe1 apartados que solo ser\xe1n accesibles por usuarios registrados o autorizados, como la publicaci\xf3n de anuncio."),(0,t.kt)("admonition",{title:"Explicaci\xf3n conceptual",type:"info"},(0,t.kt)("p",{parentName:"admonition"},"Imagina que est\xe1s en un parque de diversiones con diferentes \xe1reas: una monta\xf1a rusa, una piscina, una zona de juegos y un \xe1rea VIP. Para ingresar al \xe1rea VIP, necesitas un pase especial."),(0,t.kt)("p",{parentName:"admonition"},'En una aplicaci\xf3n web, las rutas son como las \xe1reas del parque. Cada ruta tiene una direcci\xf3n \xfanica, como "tupagina.com/monta\xf1arusa" o "tupagina.com/zonavip". Las rutas determinan qu\xe9 contenido se mostrar\xe1 al usuario cuando visite esa direcci\xf3n.'),(0,t.kt)("p",{parentName:"admonition"},"Ahora, las vistas son como los lugares dentro del parque. Cada vista es una p\xe1gina o una secci\xf3n espec\xedfica de tu aplicaci\xf3n web. Puede ser la p\xe1gina de inicio, un formulario de registro o una p\xe1gina de perfil de usuario."),(0,t.kt)("p",{parentName:"admonition"},'Aqu\xed viene lo interesante: las rutas protegidas son como el \xe1rea VIP en el parque de diversiones. Son rutas especiales que requieren un "pase" para acceder. En el caso de una aplicaci\xf3n web, este "pase" es la autenticaci\xf3n del usuario, lo que significa que deben iniciar sesi\xf3n con un nombre de usuario y contrase\xf1a.'),(0,t.kt)("p",{parentName:"admonition"},'Cuando tienes una ruta protegida, como "tupagina.com/zonavip", solo los usuarios que han iniciado sesi\xf3n y tienen el "pase" (es decir, la autenticaci\xf3n) pueden acceder a esa ruta. Si alguien intenta visitar la ruta protegida sin haber iniciado sesi\xf3n, se le redireccionar\xe1 a otra p\xe1gina, como la p\xe1gina de inicio de sesi\xf3n, para obtener el "pase" necesario.'),(0,t.kt)("p",{parentName:"admonition"},"Las vistas protegidas son como las atracciones dentro del \xe1rea VIP. Contienen contenido exclusivo que solo los usuarios autenticados pueden ver y disfrutar. Puede ser informaci\xf3n confidencial, funcionalidades avanzadas o simplemente una experiencia especial reservada para usuarios registrados."),(0,t.kt)("p",{parentName:"admonition"},"En resumen, las rutas y vistas protegidas son como \xe1reas especiales y exclusivas en un parque de diversiones. Las rutas protegidas requieren que los usuarios inicien sesi\xf3n para acceder a ellas, y las vistas protegidas contienen contenido exclusivo para usuarios autenticados. De esta manera, puedes mantener la seguridad y privacidad en tu aplicaci\xf3n web, permitiendo solo a los usuarios autorizados acceder a ciertas \xe1reas o ver cierta informaci\xf3n.")),(0,t.kt)("h2",{id:"jetstream"},"JetStream"),(0,t.kt)("p",null,"JetStream es una biblioteca de autenticaci\xf3n y scaffolding (generaci\xf3n de c\xf3digo inicial) para Laravel. JetStream proporciona un conjunto de herramientas y caracter\xedsticas para agilizar el proceso de autenticaci\xf3n y gesti\xf3n de usuarios en tu aplicaci\xf3n."),(0,t.kt)("p",null,"Una de las principales caracter\xedsticas de JetStream es su enfoque en la autenticaci\xf3n basada en la API (API-based authentication). Esto significa que JetStream est\xe1 dise\xf1ado para admitir tanto aplicaciones web tradicionales como aplicaciones de una sola p\xe1gina (SPA) o aplicaciones m\xf3viles que se comunican con una API. Proporciona un sistema de autenticaci\xf3n completo que incluye registro, inicio de sesi\xf3n, recuperaci\xf3n de contrase\xf1as y gesti\xf3n de sesiones."),(0,t.kt)("p",null,"JetStream utiliza la biblioteca de componentes de front-end Livewire o Inertia.js para generar la interfaz de usuario de las p\xe1ginas de autenticaci\xf3n. Livewire es una biblioteca que combina la interactividad del front-end con la comodidad del back-end de Laravel, mientras que Inertia.js permite a los desarrolladores construir aplicaciones de una sola p\xe1gina utilizando componentes de Laravel y Vue.js o React.js."),(0,t.kt)("p",null,"Adem\xe1s de la autenticaci\xf3n, JetStream tambi\xe9n incluye caracter\xedsticas como la verificaci\xf3n de correo electr\xf3nico, el sistema de dos factores de autenticaci\xf3n (2FA) para mejorar la seguridad, la gesti\xf3n de equipos (para aplicaciones con colaboradores) y la administraci\xf3n de perfiles de usuario."),(0,t.kt)("p",null,"JetStream proporciona una configuraci\xf3n sencilla y un flujo de trabajo simplificado para la autenticaci\xf3n en Laravel. Puedes personalizar y adaptar las vistas y funcionalidades seg\xfan las necesidades de tu aplicaci\xf3n, lo que te permite ahorrar tiempo en la implementaci\xf3n y centrarte en el desarrollo de las caracter\xedsticas espec\xedficas de tu proyecto."),(0,t.kt)("p",null,"JetStream es una biblioteca que agiliza la implementaci\xf3n de la autenticaci\xf3n y la gesti\xf3n de usuarios en aplicaciones web Laravel. Proporciona un sistema de autenticaci\xf3n completo, caracter\xedsticas de seguridad adicionales y una experiencia de desarrollo eficiente, lo que te permite crear r\xe1pidamente aplicaciones seguras y escalables. En este libro nos concentraremos en la parte de autenticaci\xf3n de JetStream."),(0,t.kt)("h2",{id:"cambiar-la-p\xe1gina-de-inicio-de-la-aplicaci\xf3n"},"Cambiar la p\xe1gina de inicio de la aplicaci\xf3n"),(0,t.kt)("p",null,"En Jetstream, se puede personalizar la redirecci\xf3n despu\xe9s del registro en el archivo ",(0,t.kt)("inlineCode",{parentName:"p"},"app/Providers/RouteServiceProvider.php"),"."),(0,t.kt)("p",null,"Busca el m\xe9todo ",(0,t.kt)("inlineCode",{parentName:"p"},"public const HOME = '/dashboard';")," en la parte superior de la clase y cambia la ruta '/dashboard' por la ruta que desees, en este caso '/home':"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-php"},"public const HOME = '/home';\n")),(0,t.kt)("p",null,"Luego, agrega el uso del namespace para ",(0,t.kt)("inlineCode",{parentName:"p"},"RedirectResponse")," y el facad de ",(0,t.kt)("inlineCode",{parentName:"p"},"Auth")," al comienzo de la clase:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-php"},"use Illuminate\\Http\\RedirectResponse;\nuse Illuminate\\Support\\Facades\\Auth;\n")),(0,t.kt)("p",null,"Finalmente, actualiza el m\xe9todo ",(0,t.kt)("inlineCode",{parentName:"p"},"public function redirectTo(): RedirectResponse")," para redirigir al usuario a la ruta deseada:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-php"},"public function redirectTo(): RedirectResponse\n{\n    return redirect()->route('home');\n}\n")),(0,t.kt)("h2",{id:"modificando-nuestro-layout"},"Modificando nuestro Layout"),(0,t.kt)("p",null,"A continuaci\xf3n vamos a modificar el men\xfa de la aplicaci\xf3n para restringir el acceso de ciertas partes de la aplicaci\xf3n a determinados usuarios."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-php"},' \x3c!-- Barra de navegaci\xf3n --\x3e\n<div class="menu container-fluid fixed-top bg-white">\n<div class="container-fluid">\n<nav class="navbar navbar-expand-lg navbar-light bg-white">\n    <a class="navbar-brand" href="/">\n        <img src="/images/logo.png" width="60" alt="..." loading="lazy">\n        <span class="nav-item resaltado">Anuncios segunda mano</span></a>\n    <button class="navbar-toggler" type="button" data-toggle="collapse"\n        data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"\n        aria-label="Toggle navigation">\n        <span class="navbar-toggler-icon"></span>\n    </button>\n\n    <div class="collapse navbar-collapse" id="navbarSupportedContent">\n        <ul class="navbar-nav ml-auto">\n            <li class="nav-item active">\n                <a class="nav-item" href="{{ route(\'home\') }}"><i class="fas fa-home"></i> Home<span\n                        class="sr-only">(current)</span></a>\n            </li>\n\n            <li class="nav-item ml-2 dropdown">\n                <a class="nav-item dropdown-toggle ml-2" href="#" id="navbarDropdown" role="button"\n                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                    <i class="fas fa-user-plus"></i>\n                    @if (!auth()->check())\n                    @else\n                        {{ auth()->user()->name }}\n                    @endif\n\n                </a>\n                <div class="dropdown-menu" aria-labelledby="navbarDropdown">\n                    <a class="dropdown-item" href="{{ route(\'registro\') }}">Registro</a>\n                    @if (!auth()->check())\n                        <a class="dropdown-item" href="{{ route(\'login2\') }}">Iniciar sesi\xf3n</a>\n                    @endif\n\n                    @can(\'admin.home\')\n                        <a class="dropdown-item" href={{ route(\'admin.home\') }}>Administraci\xf3n</a>\n                    @endcan\n                    <div class="dropdown-divider"></div>\n                    @if (auth()->check())\n                        <form id="logout-form" action="{{ route(\'logout\') }}" method="POST"\n                            style="display: none;">\n                            @csrf\n                        </form>\n\n                        <a class="dropdown-item " href="{{ route(\'logout\') }}"\n                            onclick="event.preventDefault();\n                                document.getElementById(\'logout-form\').submit();">\n                            Logout\n                        </a>\n                    @endif\n\n                </div>\n            </li>\n\n\n            <li class="nav-item ml-2">\n                <a href="{{ route(\'anuncios.create\') }}"><i class="far fa-file-alt"></i> Publicar\n                    anuncio</a>\n            </li>\n\n        </ul>\n\n    </div>\n</nav>\n')),(0,t.kt)("admonition",{title:"Que hace",type:"info"},(0,t.kt)("ol",{parentName:"admonition"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Comprobaci\xf3n del estado de autenticaci\xf3n: Se utiliza la condici\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"@if (!auth()->check())")," para verificar si el usuario actual ha iniciado sesi\xf3n. La funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"auth()->check()")," comprueba si hay un usuario autenticado en el sistema.")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Mostrar el nombre del usuario autenticado: Si el usuario ha iniciado sesi\xf3n, se muestra su nombre en el men\xfa de navegaci\xf3n. Esto se logra utilizando ",(0,t.kt)("inlineCode",{parentName:"p"},"{{ auth()->user()->name }}"),". La funci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"auth()->user()")," devuelve la instancia del usuario autenticado y ",(0,t.kt)("inlineCode",{parentName:"p"},"name")," es una propiedad del usuario que contiene su nombre.")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Opciones de autenticaci\xf3n: Dependiendo del estado de autenticaci\xf3n del usuario, se muestran diferentes opciones en el men\xfa de navegaci\xf3n. "),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Si el usuario no ha iniciado sesi\xf3n (",(0,t.kt)("inlineCode",{parentName:"p"},"@if (!auth()->check())"),'), se muestran las opciones "Registro" y "Iniciar sesi\xf3n". Estas opciones redirigen a las rutas ',(0,t.kt)("inlineCode",{parentName:"p"},"registro")," y ",(0,t.kt)("inlineCode",{parentName:"p"},"login2"),", respectivamente.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},'Si el usuario ha iniciado sesi\xf3n, se muestra la opci\xf3n "Logout" que permite al usuario cerrar sesi\xf3n. Al hacer clic en "Logout", se env\xeda una solicitud POST al servidor a trav\xe9s del formulario con el id ',(0,t.kt)("inlineCode",{parentName:"p"},"logout-form"),". El formulario contiene un campo CSRF (Token de protecci\xf3n contra falsificaciones de solicitudes entre sitios) generado por Laravel para proteger contra ataques CSRF.")))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Acceso de administrador: Se utiliza la directiva ",(0,t.kt)("inlineCode",{parentName:"p"},"@can('admin.home')"),' para verificar si el usuario autenticado tiene el permiso de "admin.home". Si el usuario tiene ese permiso, se muestra la opci\xf3n "Administraci\xf3n" en el men\xfa de navegaci\xf3n. La opci\xf3n "Administraci\xf3n" redirige a la ruta ',(0,t.kt)("inlineCode",{parentName:"p"},"admin.home"),"."))),(0,t.kt)("p",{parentName:"admonition"},"Estas caracter\xedsticas permiten que el men\xfa de navegaci\xf3n se adapte al estado de autenticaci\xf3n del usuario, mostrando las opciones adecuadas seg\xfan corresponda.")))}p.isMDXComponent=!0}}]);